<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <link rel="stylesheet" href="/assets/css/just-the-docs-default.css"> <link rel="stylesheet" href="/assets/css/just-the-docs-head-nav.css" id="jtd-head-nav-stylesheet"> <style id="jtd-nav-activation"> .site-nav > ul.nav-list:first-child > li > a, .site-nav > ul.nav-list:first-child > li > ul > li > a, .site-nav > ul.nav-list:first-child > li > ul > li > ul > li:not(:nth-child(1)) > a { background-image: none; } .site-nav > ul.nav-list:not(:first-child) a, .site-nav li.external a { background-image: none; } .site-nav > ul.nav-list:first-child > li:nth-child(7) > ul > li:nth-child(1) > ul > li:nth-child(1) > a { font-weight: 600; text-decoration: none; }.site-nav > ul.nav-list:first-child > li:nth-child(7) > button svg, .site-nav > ul.nav-list:first-child > li:nth-child(7) > ul > li:nth-child(1) > button svg { transform: rotate(-90deg); }.site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(7) > ul.nav-list, .site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(7) > ul.nav-list > li.nav-list-item:nth-child(1) > ul.nav-list { display: block; } </style> <script src="/assets/js/vendor/lunr.min.js"></script> <script src="/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <link rel="icon" href="/assets/images/logo.png" type="image/x-icon"> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>Surface Model | ViennaPS Documentation</title> <meta name="generator" content="Jekyll v4.3.3" /> <meta property="og:title" content="Surface Model" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="The documentation for ViennaPS" /> <meta property="og:description" content="The documentation for ViennaPS" /> <link rel="canonical" href="http://localhost:4000/models/custom/surfaceModel.html" /> <meta property="og:url" content="http://localhost:4000/models/custom/surfaceModel.html" /> <meta property="og:site_name" content="ViennaPS Documentation" /> <meta property="og:type" content="website" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Surface Model" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","description":"The documentation for ViennaPS","headline":"Surface Model","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"http://localhost:4000/assets/images/logo.png"}},"url":"http://localhost:4000/models/custom/surfaceModel.html"}</script> <!-- End Jekyll SEO tag --> </head> <body> <a class="skip-to-main" href="#main-content">Skip to main content</a> <svg xmlns="http://www.w3.org/2000/svg" class="d-none"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <!-- Feather. MIT License: https://github.com/feathericons/feather/blob/master/LICENSE --> <symbol id="svg-external-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"> <title id="svg-external-link-title">(external link)</title> <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <!-- Bootstrap Icons. MIT License: https://github.com/twbs/icons/blob/main/LICENSE.md --> <symbol id="svg-copy" viewBox="0 0 16 16"> <title>Copy</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16"> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/> <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/> </svg> </symbol> <symbol id="svg-copied" viewBox="0 0 16 16"> <title>Copied</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check-fill" viewBox="0 0 16 16"> <path d="M6.5 0A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3Zm3 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3Z"/> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1A2.5 2.5 0 0 1 9.5 5h-3A2.5 2.5 0 0 1 4 2.5v-1Zm6.854 7.354-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708.708Z"/> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header" role="banner"> <a href="/" class="site-title lh-tight"><img src="/assets/images/logo.png" alt="Logo" class="logo"><pre> </pre><p style="color:rgb(0, 80, 119);font-size:140%;">ViennaPS</p></a> <button id="menu-button" class="site-button btn-reset" aria-label="Toggle menu" aria-pressed="false"> <svg viewBox="0 0 24 24" class="icon" aria-hidden="true"><use xlink:href="#svg-menu"></use></svg> </button> </div> <nav aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="/" class="nav-list-link">Home</a></li><li class="nav-list-item"><a href="/deps/" class="nav-list-link">Dependencies</a></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Installing the Library category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/inst/" class="nav-list-link">Installing the Library</a><ul class="nav-list"><li class="nav-list-item"><a href="/inst/gpu.html" class="nav-list-link">GPU Module</a></li><li class="nav-list-item"><a href="/inst/troubleshooting.html" class="nav-list-link">Troubleshooting</a></li></ul></li><li class="nav-list-item"><a href="/general/" class="nav-list-link">General Notes</a></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Simulation Domain category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/domain/" class="nav-list-link">Simulation Domain</a><ul class="nav-list"><li class="nav-list-item"><a href="/domain/surface.html" class="nav-list-link">Surface and Material Interfaces</a></li><li class="nav-list-item"><a href="/domain/volume.html" class="nav-list-link">Volume</a></li><li class="nav-list-item"><a href="/domain/material.html" class="nav-list-link">Material Mapping</a></li><li class="nav-list-item"><a href="/domain/functions.html" class="nav-list-link">Member Functions</a></li><li class="nav-list-item"><a href="/domain/setup.html" class="nav-list-link">Domain Setup</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Creating a Geometry category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/geo/" class="nav-list-link">Creating a Geometry</a><ul class="nav-list"><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Geometry Builders category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/geo/basic/" class="nav-list-link">Geometry Builders</a><ul class="nav-list"><li class="nav-list-item"> <a href="/geo/basic/plane.html" class="nav-list-link">Plane Geometry</a> </li><li class="nav-list-item"> <a href="/geo/basic/trench.html" class="nav-list-link">Trench Geometry</a> </li><li class="nav-list-item"> <a href="/geo/basic/hole.html" class="nav-list-link">Hole Geometry</a> </li><li class="nav-list-item"> <a href="/geo/basic/fin.html" class="nav-list-link">Fin Geometry</a> </li><li class="nav-list-item"> <a href="/geo/basic/stack.html" class="nav-list-link">Stack Geometry</a> </li></ul></li><li class="nav-list-item"><a href="/geo/custom.html" class="nav-list-link">Custom Geometry</a></li><li class="nav-list-item"><a href="/geo/gdsimport.html" class="nav-list-link">GDS File Import</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Process Models category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/models/" class="nav-list-link">Process Models</a><ul class="nav-list"><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Custom Models category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/models/custom/" class="nav-list-link">Custom Models</a><ul class="nav-list"><li class="nav-list-item"> <a href="/models/custom/surfaceModel.html" class="nav-list-link">Surface Model</a> </li><li class="nav-list-item"> <a href="/models/custom/velocityField.html" class="nav-list-link">Velocity Field</a> </li><li class="nav-list-item"> <a href="/models/custom/particle.html" class="nav-list-link">Particles - Flux Calculation</a> </li><li class="nav-list-item"> <a href="/models/custom/sourceDirection.html" class="nav-list-link">Primary Source Direction</a> </li><li class="nav-list-item"> <a href="/models/custom/advectionCallback.html" class="nav-list-link">Advection Callback</a> </li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Pre-Built Models category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/models/prebuilt/" class="nav-list-link">Pre-Built Models</a><ul class="nav-list"><li class="nav-list-item"> <a href="/models/prebuilt/isotropic.html" class="nav-list-link">Isotropic Process</a> </li><li class="nav-list-item"> <a href="/models/prebuilt/directional.html" class="nav-list-link">Directional Process</a> </li><li class="nav-list-item"> <a href="/models/prebuilt/singleParticle.html" class="nav-list-link">Single Particle Process</a> </li><li class="nav-list-item"> <a href="/models/prebuilt/multiParticle.html" class="nav-list-link">Multi Particle Process</a> </li><li class="nav-list-item"> <a href="/models/prebuilt/SF6O2Etching.html" class="nav-list-link">SF<sub>6</sub>O<sub>2</sub> Etching</a> </li><li class="nav-list-item"> <a href="/models/prebuilt/TEOS.html" class="nav-list-link">TEOS Deposition</a> </li><li class="nav-list-item"> <a href="/models/prebuilt/TEOSPECVD.html" class="nav-list-link">TEOS PE CVD Process</a> </li><li class="nav-list-item"> <a href="/models/prebuilt/fluorocarbonEtching.html" class="nav-list-link">Fluorocarbon Etching</a> </li><li class="nav-list-item"> <a href="/models/prebuilt/IBE.html" class="nav-list-link">Ion Beam Etching</a> </li><li class="nav-list-item"> <a href="/models/prebuilt/wetEtching.html" class="nav-list-link">Wet Etching</a> </li><li class="nav-list-item"> <a href="/models/prebuilt/selectiveEpitaxy.html" class="nav-list-link">Selective Epitaxy</a> </li><li class="nav-list-item"> <a href="/models/prebuilt/geometric.html" class="nav-list-link">Geometric Models</a> </li></ul></li></ul></li><li class="nav-list-item"><a href="/process/" class="nav-list-link">Running a Process</a></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Geometry Output category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/output/" class="nav-list-link">Geometry Output</a><ul class="nav-list"><li class="nav-list-item"><a href="/output/levelset.html" class="nav-list-link">Level Set</a></li><li class="nav-list-item"><a href="/output/surface.html" class="nav-list-link">Surface Mesh</a></li><li class="nav-list-item"><a href="/output/volume.html" class="nav-list-link">Volume Mesh</a></li><li class="nav-list-item"><a href="/output/metadata.html" class="nav-list-link">VTK Metadata Export</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Miscellaneous category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/misc/" class="nav-list-link">Miscellaneous</a><ul class="nav-list"><li class="nav-list-item"><a href="/misc/planarize.html" class="nav-list-link">Planarize Geometry</a></li><li class="nav-list-item"><a href="/misc/extrusion.html" class="nav-list-link">Geometry Extrusion and Slicing</a></li><li class="nav-list-item"><a href="/misc/logging.html" class="nav-list-link">Logging</a></li><li class="nav-list-item"><a href="/misc/units.html" class="nav-list-link">Units</a></li></ul></li><li class="nav-list-item"><a href="/examples/" class="nav-list-link">Examples</a></li></ul> <ul class="nav-list"><li class="nav-list-item external"> <a href="https://github.com/ViennaTools/ViennaPS" class="nav-list-link external" > ViennaPS on Github <svg viewBox="0 0 24 24" aria-labelledby="svg-external-link-title"><use xlink:href="#svg-external-link"></use></svg> </a> </li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/just-the-docs/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search" role="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search ViennaPS Documentation" aria-label="Search ViennaPS Documentation" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> <nav aria-label="Auxiliary" class="aux-nav"> <ul class="aux-nav-list"> <li class="aux-nav-list-item"> <a href="https://github.com/ViennaTools/ViennaPS" class="site-button" > ViennaPS on Github </a> </li> </ul> </nav> </div> <div class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="/models/">Process Models</a></li> <li class="breadcrumb-nav-list-item"><a href="/models/custom/">Custom Models</a></li> <li class="breadcrumb-nav-list-item"><span>Surface Model</span></li> </ol> </nav> <div id="main-content" class="main-content"> <main> <h1 class="fs-9 fw-500" id="surface-model"> <a href="#surface-model" class="anchor-heading" aria-labelledby="surface-model"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Surface Model </h1> <hr /> <h2 id="summary"> <a href="#summary" class="anchor-heading" aria-labelledby="summary"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Summary </h2> <ul> <li>The <code class="language-plaintext highlighter-rouge">SurfaceModel</code> class is used to describe surface reactions, combining particle fluxes with the surface chemical reactions.</li> <li>The velocities used for surface advection in a time step are calculated through the <code class="language-plaintext highlighter-rouge">calculateVelocities()</code> function.</li> <li>Surface coverages can be used to track the coverage a chemical species on the surface through a time step.</li> <li>The coverages can be initialized to equilibrium by iteratively calculating the fluxes on the surface and updating the coverages. The number of iterations to initialize the coverages can be specified through the <a href="/process/"><code class="language-plaintext highlighter-rouge">Process</code></a>.</li> <li>Coverages and fluxes are stored as <code class="language-plaintext highlighter-rouge">viennals::PointData</code>.</li> </ul><hr /> <p>The <code class="language-plaintext highlighter-rouge">SurfaceModel</code> class serves as a comprehensive framework for detailing surface chemistries. Users have the flexibility to create a customized child class where they can precisely dictate how surface coverages evolve, driven by the rates at which particles impact the surface.</p> <p>One key feature is the capability to monitor surface coverages, providing insights into the presence of chemical species on the surface throughout a simulation’s time step. To initialize the coverage data vector, the method <code class="language-plaintext highlighter-rouge">initializeCoverages()</code> is employed.</p> <div class="language-c++ highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="kt">void</span> <span class="nf">initializeCoverages</span><span class="p">(</span><span class="kt">unsigned</span> <span class="n">numSurfacePoints</span><span class="p">)</span> <span class="k">override</span> <span class="p">{</span>
    <span class="c1">// a single set of coverages is initialized here</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">NumericType</span><span class="o">&gt;</span> <span class="n">someCoverage</span><span class="p">(</span><span class="n">numSurfacePoints</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>

    <span class="n">coverages</span> <span class="o">=</span> <span class="n">ps</span><span class="o">::</span><span class="n">SmartPointer</span><span class="o">&lt;</span><span class="n">viennals</span><span class="o">::</span><span class="n">PointData</span><span class="o">&lt;</span><span class="n">NumericType</span><span class="o">&gt;&gt;::</span><span class="n">New</span><span class="p">();</span>
    <span class="n">coverages</span><span class="o">-&gt;</span><span class="n">insertNextScalarData</span><span class="p">(</span><span class="n">someCoverage</span><span class="p">,</span> <span class="s">"someCoverage"</span><span class="p">);</span>
  <span class="p">}</span>
</code></pre></div></div> <p>To use coverages, it is essential to initialize the class member <code class="language-plaintext highlighter-rouge">coverages</code> with a new instance of <code class="language-plaintext highlighter-rouge">viennals::PointData</code>. If the <code class="language-plaintext highlighter-rouge">coverages</code> variable is left as <code class="language-plaintext highlighter-rouge">nullptr</code>, no coverages will be utilized during the simulation. To initialize a single coverage, a container with a size equal to the number of surface points must be created and inserted into the <code class="language-plaintext highlighter-rouge">viennals::PointData</code>. Additionally, a name for the coverage can be specified during initialization. This designated name should then be used in <code class="language-plaintext highlighter-rouge">updateCoverages()</code> or <code class="language-plaintext highlighter-rouge">calculateVelocities()</code> to access the specific coverage as needed.</p> <p>To ensure accurate representations, coverages can be initialized to equilibrium by iteratively calculating surface fluxes and updating coverages. The initialization process’s iteration count is customizable through the <a href="/process/">Process</a> interface. The method <code class="language-plaintext highlighter-rouge">updateCoverages()</code> encapsulates the user-defined description of surface coverage evolution in each iteration. Since <code class="language-plaintext highlighter-rouge">coverages</code> is a member of the <code class="language-plaintext highlighter-rouge">psSurfaceModel</code> class, it can be accessed in every member function.</p> <div class="language-c++ highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="kt">void</span> <span class="nf">updateCoverages</span><span class="p">(</span><span class="n">ps</span><span class="o">::</span><span class="n">SmartPointer</span><span class="o">&lt;</span><span class="n">viennals</span><span class="o">::</span><span class="n">PointData</span><span class="o">&lt;</span><span class="n">NumericType</span><span class="o">&gt;&gt;</span> <span class="n">particleFluxes</span><span class="p">,</span>
                       <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">NumericType</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">materialIds</span><span class="p">)</span> <span class="k">override</span> <span class="p">{</span>
    <span class="k">auto</span> <span class="n">myCoverage</span> <span class="o">=</span> <span class="n">coverages</span><span class="o">-&gt;</span><span class="n">getScalarData</span><span class="p">(</span><span class="s">"someCoverage"</span><span class="p">);</span>
    <span class="c1">// update coverage from calculated fluxes</span>
  <span class="p">}</span>
</code></pre></div></div> <p>Within the <code class="language-plaintext highlighter-rouge">psSurfaceModel</code> class, the method <code class="language-plaintext highlighter-rouge">calculateVelocities()</code> utilizes fluxes obtained through ray tracing, to provide the velocities used for surface advection in a time step. Here the fluxes from particle, as well as previously calculated coverages can be accessed and combined to yield the final velocity at each surface point. The function should return a <code class="language-plaintext highlighter-rouge">SmartPointer</code> to a new vector, containing the velocity at each surface point.</p> <p>In order to create a custom surface the user has to interface the <code class="language-plaintext highlighter-rouge">SurfaceModel</code> class. An example implementation of a custom surface model is given below:</p> <div class="language-c++ highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">template</span> <span class="o">&lt;</span><span class="k">typename</span> <span class="nc">NumericType</span><span class="p">&gt;</span>
<span class="k">class</span> <span class="nc">myCustomSurfaceModel</span> <span class="o">:</span> <span class="k">public</span> <span class="n">ps</span><span class="o">::</span><span class="n">SurfaceModel</span><span class="o">&lt;</span><span class="n">NumericType</span><span class="o">&gt;</span> <span class="p">{</span>
<span class="nl">public:</span>
  <span class="k">using</span> <span class="n">ps</span><span class="o">::</span><span class="n">SurfaceModel</span><span class="o">&lt;</span><span class="n">NumericType</span><span class="o">&gt;::</span><span class="n">coverages</span><span class="p">;</span> <span class="c1">// needed to access coverages</span>

  <span class="kt">void</span> <span class="n">initializeCoverages</span><span class="p">(</span><span class="kt">unsigned</span> <span class="n">numSurfacePoints</span><span class="p">)</span> <span class="k">override</span> <span class="p">{</span>
    <span class="c1">// a single set of coverages is initialized here</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">NumericType</span><span class="o">&gt;</span> <span class="n">someCoverage</span><span class="p">(</span><span class="n">numSurfacePoints</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>

    <span class="n">coverages</span> <span class="o">=</span> <span class="n">ps</span><span class="o">::</span><span class="n">SmartPointer</span><span class="o">&lt;</span><span class="n">viennals</span><span class="o">::</span><span class="n">PointData</span><span class="o">&lt;</span><span class="n">NumericType</span><span class="o">&gt;&gt;::</span><span class="n">New</span><span class="p">();</span>
    <span class="n">coverages</span><span class="o">-&gt;</span><span class="n">insertNextScalarData</span><span class="p">(</span><span class="n">someCoverage</span><span class="p">,</span> <span class="s">"someCoverage"</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="kt">void</span> <span class="nf">updateCoverages</span><span class="p">(</span><span class="n">ps</span><span class="o">::</span><span class="n">SmartPointer</span><span class="o">&lt;</span><span class="n">viennals</span><span class="o">::</span><span class="n">PointData</span><span class="o">&lt;</span><span class="n">NumericType</span><span class="o">&gt;&gt;</span> <span class="n">particleFluxes</span><span class="p">,</span>
                       <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">NumericType</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">materialIds</span><span class="p">)</span> <span class="k">override</span> <span class="p">{</span>
    <span class="k">auto</span> <span class="n">myCoverage</span> <span class="o">=</span> <span class="n">coverages</span><span class="o">-&gt;</span><span class="n">getScalarData</span><span class="p">(</span><span class="s">"someCoverage"</span><span class="p">);</span>
    <span class="c1">// update coverage from calculated fluxes</span>
  <span class="p">}</span>

  <span class="n">ps</span><span class="o">::</span><span class="n">SmartPointer</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">NumericType</span><span class="o">&gt;&gt;</span> <span class="n">calculateVelocities</span><span class="p">(</span>
      <span class="n">ps</span><span class="o">::</span><span class="n">SmartPointer</span><span class="o">&lt;</span><span class="n">viennals</span><span class="o">::</span><span class="n">PointData</span><span class="o">&lt;</span><span class="n">NumericType</span><span class="o">&gt;&gt;</span> <span class="n">rates</span><span class="p">,</span>
      <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">array</span><span class="o">&lt;</span><span class="n">NumericType</span><span class="p">,</span> <span class="mi">3</span><span class="o">&gt;&gt;</span> <span class="o">&amp;</span><span class="n">coordinates</span><span class="p">,</span>
      <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">NumericType</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">materialIds</span><span class="p">)</span> <span class="k">override</span> <span class="p">{</span>
    <span class="c1">// use coverages and rates here to calculate the velocity here</span>
    <span class="k">return</span> <span class="n">ps</span><span class="o">::</span><span class="n">SmartPointer</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">NumericType</span><span class="o">&gt;&gt;::</span><span class="n">New</span><span class="p">(</span>
        <span class="o">*</span><span class="n">rates</span><span class="o">-&gt;</span><span class="n">getScalarData</span><span class="p">(</span><span class="s">"particleRate"</span><span class="p">));</span>
  <span class="p">}</span>
<span class="p">};</span>
</code></pre></div></div> </main> <hr> <footer> <div class="d-flex mt-2"> </div> </footer> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
